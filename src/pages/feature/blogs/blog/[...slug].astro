---
import "@fontsource/jetbrains-mono";
import BaseHead from "@modules/blogs-module/core/head/base-head.astro";

import {
    ProductBlogLayout,
    ProductBlogsBodyLayout,
} from "@modules/blogs-module";
import {
    BaseGlobalStyle,
    BaseMaterialTheme,
    ImportJetbrainsMonoStyle,
    ImportMaterialSymbols,
} from "@modules/shared-module";

import { getCollection, type CollectionEntry } from "astro:content";
import { ViewTransitions } from "astro:transitions";
import ProductRootHtmlLayout from "src/layouts/ProductRootHtmlLayout.astro";

export async function getStaticPaths() {
    /**
     * Please complete the code here.
     * Please confirm that there is an mdx file in the src/content/blogs/* folder.
     *
     * This project provides `blog` folder by default.
     */
    const posts = await getCollection("blog");

    /**
     * Copied.
     * @link https://docs.astro.build/en/guides/markdown-content/#example-dynamic-page-routing
     */
    return posts.map((post) => ({
        params: {
            slug: post.slug,
        },
        props: {
            blog: post,
        },
    }));
}
interface Props {
    blog: CollectionEntry<"blog">;
}

const { blog } = Astro.props;
const { Content } = await blog.render();
---

<ProductRootHtmlLayout>
    <BaseHead slot="head" />

    <ImportJetbrainsMonoStyle slot="head-after" />
    <BaseMaterialTheme slot="head-after" />
    <BaseGlobalStyle slot="head-after" />
    <ImportMaterialSymbols slot="head-after" />

    <ViewTransitions slot="head-after" />

    <ProductBlogsBodyLayout>
        <ProductBlogLayout
            markdownString={blog.body}
            collection={blog.data.collection}
            creationTime={blog.data.creationTime}
            description={blog.data.description}
            headline={blog.data.headline}
            tags={blog.data.tags}
        >
            <Content />
        </ProductBlogLayout>
    </ProductBlogsBodyLayout>
</ProductRootHtmlLayout>

<style>
    @layer default-family {
        html,
        body {
            font-family:
                "Jetbrains mono",
                "Roboto",
                "Noto",
                "Noto Sans",
                ui-sans-serif,
                system-ui,
                -apple-system,
                BlinkMacSystemFont,
                "Segoe UI",
                "Helvetica Neue",
                Arial,
                sans-serif,
                "Apple Color Emoji",
                "Segoe UI Emoji",
                "Segoe UI Symbol",
                "Noto Color Emoji";
        }
    }
</style>
