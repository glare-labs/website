---
import UnfoldMoreSvg from "@material-design-icons/svg/round/unfold_more.svg?raw";
import UnfoldLessSvg from "@material-design-icons/svg/round/unfold_less.svg?raw";

interface Props {
    overview: string;
}

const { overview } = Astro.props;
---

<div class="blog-overview" data-show-full-content="false" role="article" aria-label="Ai Overview" aria-roledescription="The content of the Overview is generated by AI.">
    <h1 class="title md-typescale-title-medium">Overview</h1>
    <p class="description md-typescale-body-small">The content of the Overview is generated by AI.</p>
    <p class="content md-typescale-body-medium">
        {overview}
    </p>

    <div class="expand" role="button">
        <md-outlined-button class="expand-button">
            Expand All
            <md-icon slot="icon" set:html={UnfoldMoreSvg} />
        </md-outlined-button>
        <md-outlined-button class="fold-button">
            Fold All
            <md-icon slot="icon" set:html={UnfoldLessSvg} />
        </md-outlined-button>
    </div>

    <div class="background" aria-hidden="true"></div>
</div>

<script>
    import "@material/web/button/outlined-button";
    import "@material/web/icon/icon";
</script>

<script>
    document.addEventListener("astro:page-load", () => {
        const overview = document.querySelector(".blog-overview") as HTMLElement;
        const expandButton = overview.querySelector(".expand-button");
        const foldButton = overview.querySelector(".fold-button");

        expandButton.addEventListener("click", () => {
            overview.setAttribute("data-show-full-content", "true");
        });
        foldButton.addEventListener("click", () => {
            overview.setAttribute("data-show-full-content", "false");
        });
    });
</script>

<style>
    .blog-overview {
        border-width: 1px;
        border-color: var(--md-sys-color-primary-container);
        border-radius: 28px;
        margin: 16px;
        z-index: 0;
        overflow: hidden;
        position: relative;

        & > .background {
            position: absolute;
            inset: 0;
            border-radius: inherit;
            z-index: 0;
            background: linear-gradient(to bottom right, var(--md-sys-color-primary-container), transparent);
            opacity: 0.24;
        }

        & > .title {
            position: relative;
            z-index: 1;
            color: var(--md-sys-color-primary);
            margin: 24px 24px 6px;
        }
        & > .description {
            position: relative;
            z-index: 1;
            color: var(--md-sys-color-primary);
            margin: 0px 24px 32px;
            font-style: italic;
        }

        & > .content {
            position: relative;
            z-index: 1;
            color: var(--md-sys-color-primary);
            margin: 12px 24px 32px;
            transition-property: max-height, height;
            transition-duration: 200ms;
            height: 64px;
            overflow: hidden;
        }

        & > .expand {
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            position: relative;
            padding: 12px 0 12px;
            background-color: var(--md-sys-color-surface);

            transition-property: background-color, opacity;
            transition-duration: 200ms;

            --_expand-height: 72px;

            & > :is(.expand-button, .fold-button) {
                z-index: 2;
            }

            &::after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: calc(-1 * var(--_expand-height));
                z-index: 1;
                width: 100%;
                height: var(--_expand-height);
                background: linear-gradient(to bottom, transparent, var(--md-sys-color-surface) 50%);
            }
        }

        &[data-show-full-content="false"] {
            & .expand-button {
                display: block;
            }
            & .fold-button {
                display: none;
            }
        }
        &[data-show-full-content="true"] {
            & .content {
                height: fit-content;
            }
            & .expand-button {
                display: none;
            }
            & .fold-button {
                display: block;
            }
            & > .expand {
                background-color: transparent;
                &::after {
                    opacity: 0;
                }
            }
        }
    }
</style>
